<!DOCTYPE html>
<!--

|
|             *         *
|                  .                .
|           .
|     *                      ,
|                   .
|
|                               *
|          |\___/|
|          )    -(             .              '
|         =\  -  /=
|           )===(       *
|          /   - \
|          |-    |
|         /   -   \     0.|.0
|  NASY___\__( (__/_____(\=/)__+1s____________
|  ______|____) )______|______|______|______|_
|  ___|______( (____|______|______|______|____
|  ______|____\_|______|______|______|______|_
|  ___|______|______|______|______|______|____
|  ______|______|______|______|______|______|_
|  ___|______|______|______|______|______|____


Author           : Nasy https://nasy.moe <Nasy>
Date             : Mar 4, 2018
Email            : echo bmFzeXh4QGdtYWlsLmNvbQo= | base64 -D
Filename         : index.html
Last modified by : Nasy
License          : MIT


There are more things in heaven and earth, Horatio, than are dreamt.
  From "Hamlet"
-->

<html>

    <head>
        <meta charset="utf-8">

        <title>Poetry 与 Python</title>

        <meta name="HandheldFriendly" content="True">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta name="description" content="Nasy 的花园，栽花养鱼闲聊的地方～">
        <meta name="twitter:creator" content="@nasyxx">

        <meta property="og:type" content="website">
        <meta property="og:title" content="Nasy Land">
        <meta property="og:url" content="https://nasy.moe/">
        <meta property="og:site_name" content="Nasy Land">
        <meta property="og:description" content="Nasy 的花园，栽花养鱼闲聊的地方～">

        <link rel="stylesheet" href="../../styles/main.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    </head>
    <body>
        <div class="container" , id="container">

            <header class="header" id="header">
                <section class="header-section">
                    <h1 class="header-section-title main-title no-before">
                        <a href="NasyLand"> <i class="fas fa-star h1_icon"></i> </a>
                        Nasy Land
                    </h1>
                </section>
                <section class="header-section">
                    <nav class="header-section-nav nav">
                        <ul>
                            <li class="header-section-section-nav-list nav-list">
                                <a href="https://nasy.me" title="Who is Nasy?">Nasy</a>
                            </li>
                            <li class="header-section-section-nav-list nav-list">
                                <a href="../../" title="Blog">Blog</a>
                            </li>
                            <li class="header-section-section-nav-list nav-list">
                                <a href="https://pools.nasy.moe" title="Pools">Pools</a>
                            </li>
                            <li class="header-section-section-nav-list nav-list">
                                <a href="../../About#About" title="About">About</a>
                            </li>
                        </ul>
                    </nav>
                </section>
                
            </header>

            <main class="main" id="main">
                <section id="blog" class="blog">
    <header class="blog-header">
        
    <h1 id="Poetry 与 Python">
        <a href="#Poetry 与 Python">
            <i class="fas fa-star h1_icon"></i>
        </a>
        Poetry 与 Python
    </h1>
    <section class="toc-n" style="cursor: context-menu;">
        <h3>Table of Content</h3>
    </section>
    <section class="blog-content-table">

    </section>
    <div class="h1-fixed opacity">
        <p class="h1 h1-fixed" style="position: fixed; cursor: context-menu; z-index: 3;" onclick="show_hide_toc();">Poetry 与 Python</p>
        <section class="blog-content-table h1-fixed hidden" style="position: fixed; z-index: 2; top: 50px; border-top: medium none; box-shadow: none;">

        </section>
    </div>


<section class="metas">
    
        <section class="metas-author">
            <i class="icon fas fa-pencil-alt" title="author"></i>
            <span>Nasy</span>
        </section>
    

    
        <section class="metas-time">
            <i class="icon far fa-calendar-alt" title="time"></i>
            <time datetime="August 15, 2018">August 15, 2018</time>
        </section>
    

    
        <section class="metas-summary">
            <i class="icon fas fa-quote-left" title="summary"></i>
            <span>好用的 Python 依赖管理以及打包工具 Poetry.</span>
        </section>
    

    
        <section class="metas-categories">
            <i class="icon fas fa-tags" title="categories"></i>
            <ul><a href="../../categories/Grass/">Grass</a>, <a href="../../categories/Tools/">Tools</a></ul>
        </section>
    

    
        <section class="metas-tags">
            <i class="icon fas fa-hashtag" title="tags"></i>
            <ul><a href="../../tags/grass/">grass</a>, <a href="../../tags/open-source/">open-source</a>, <a href="../../tags/tools/">tools</a>, <a href="../../tags/%E8%8D%89/">草</a></ul>
        </section>
    
</section>

    </section>
    <section>
        <nav class="text-table-of-contents"><ul>
<li><a href="#poetry-是什么">Poetry 是什么？</a></li>
<li><a href="#遇见">遇见</a></li>
<li><a href="#如诗一般地使用">如诗一般地使用</a></li>
</ul></nav>
<h2 id="poetry-是什么">Poetry 是什么？</h2>
<p>Poetry: <a href="https://poetry.eustace.io" class="uri">https://poetry.eustace.io</a></p>
<p>Poetry 是一个 Python 的依赖管理以及打包工具。 用他官方的话说就是：</p>
<blockquote>
<p>Poetry is a tool for dependency management and packaging in Python. It allows you to declare the libraries your project depends on and it will manage (install/update) them for you.</p>
</blockquote>
<h2 id="遇见">遇见</h2>
<p>对于 Python 来说，虚拟环境一直有很多选择，无论是直接使用自带的 <code>virtualenv</code> ，还是通过 <code>pyenv</code> 使用 <code>virtualenv</code> ，我都觉得，用起来很不爽。原因有两个：</p>
<ul>
<li>配置麻烦</li>
<li>莫名其妙多了个文件夹</li>
<li>还多了一些文件</li>
</ul>
<p>当然，之后， <code>pipenv</code> 出世，基本把所有的内容装到了同一个文件里面。 遗憾的是，也许是乱七八糟的功能之类的太多了，我似乎用不习惯。 我所想要的是一个如同 <code>cargo</code> 或者 <code>stack</code> 那样的东西， <code>pipenv</code> 并不能很顺畅的达到这样的需求，该写 <code>makefile</code> 还是要写。</p>
<p>在一次日常浏览 GitHub Trending 的时候，我发现了 <code>Poetry</code>, 这个超棒的工具。</p>
<h2 id="如诗一般地使用">如诗一般地使用</h2>
<p>一直以来，如果是我个人使用，我都是不用任何虚拟环境的，一是麻烦，二是觉得没必要。 直到有一个有一个该死的库 <code>prompt-toolkit</code> 2.x 版本与 1.x 版本不兼容，而且一些经常使用的包还经常用它。 没错，说的就是 <code>ipython</code> 。 才让我开始注意虚拟环境，并且在一些时候使用它。 事实上，就算是 Haskell，我也是不怎么使用 local 环境下的 <code>ghci</code> 毕竟，没有高亮，没有很多乱七八糟的东西，看起来太不舒服了。 在认识 <code>Poetry</code> 之前，我一直是直接使用 <code>virtualenv</code> 或者 <code>pipenv</code> 。 很惭愧，因为没做过什么特别大的项目，我几乎不需要把环境隔离。</p>
<p><code>Poetry</code> 在各个方面都太方便了，比如说，他使用 <code>pyproject.toml</code> 这样的配置文件，而非其他的那些很多乱七八糟的。 另一方面，它提供了诸如 <code>new</code>, <code>publish</code>, <code>build</code>, <code>run</code> 这样的命令，可以说与 <code>stack</code> 体验一致。 最方便的是，不用再写 <code>makefile</code> 了。 你可以这样，在 <code>pyproject.toml</code> 里面写上:</p>
<pre class="toml"><code>[tool.poetry.scripts]
crawl_it = &quot;crawler:main&quot;
</code></pre>
<p>然后简单的 <code>poetry run crawl_it</code> 来运行，不需要费心在 <code>makefile</code> 里面写上:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode makefile"><code class="sourceCode makefile"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="dv">crawl-it:</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">        poetry run python crawler.py</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="ot">.PHONY:</span><span class="dt"> crawl-it</span></a></code></pre></div>
<p>还有一点也很重要，有了这东西，可以保证工作文件夹干净，不会出现虚拟环境的文件夹。</p>
<hr />
<p>我自己使用 Python ，最主要就是用来写爬虫。 用上 <code>Poetry</code> 之后，个人最经常的操作就是:</p>
<div class="sourceCode" id="cb3" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="fu">mkdir</span> xxxx         # 创建文件夹 xxxx</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="bu">cd</span> xxxx            # 进入</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="ex">poetry</span> init        # 项目初始化(会有一些选项选择)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="ex">emacsclient</span> -c .   # 打开最喜欢的编辑器</a></code></pre></div>
    </section>
</article>
<hr />
<div id="gitalk-comment">
</div>
<!-- gitalk -->
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    function init_comment() {
        const gitalk = new Gitalk({
            clientID: '434498d156d6042c22a4',
            clientSecret: '11c8c6cce2e0c5e23749c0602841c855293476b7',
            repo: 'comments',
            owner: 'nasyxx',
            admin: ['nasyxx'],
            id: "comment",
            labels: ['comment'],
            createIssueManually: true,
            enableHotKey: true,
            perPage: 10,
            // facebook-like distraction free mode
            distractionFreeMode: false,
            body: location.href
        })
        
        gitalk.options.id = document.querySelector("title").text;
        
        
        gitalk.render("gitalk-comment")
    }
    try{
        init_comment()
    }catch{
        console.log("Not a Blog.")
    }
</script>

            </main>

            <footer id="footer">
                <section class="footer-section">
                    <nav class="header-section-nav nav">
                        <ul>
                            <li class="footer-section-nav-list nav-list">
                                <a href="https://nasy.me" title="Who is Nasy?">Nasy</a>
                            </li>
                            <li class="footer-section-nav-list nav-list">
                                <a href="../../" title="Blog">Blog</a>
                            </li>
                            <li class="footer-section-nav-list nav-list"><a href="https://pools.nasy.moe" title="Pools">Pools</a>
                            </li>
                            <li class="footer-section-nav-list nav-list">
                                <a href="../../About#About" title="About">About</a>
                            </li>
                        </ul>
                    </nav>
                    <nav id="friend-links" class="friend-links-nav">
                        <ul>
                            <li class="footer-section-nav-list nav-list">
                              <a href="https://laobubu.net" title="laobubu">Laobubu</a>
                            </li>
                            <li class="footer-section-nav-list nav-list">
                              <a href="https://yuki.yuki233.com" title="初雪">初雪</a>
                            </li>
                            <li class="footer-section-nav-list nav-list">
                              <a href="https://mitsuhachan.ml" title="三葉的喵窝">三葉的喵窝</a>
                            </li>
                            <li class="footer-section-nav-list nav-list">
                              <a href="https://blog.zsakvo.cc" title="水水的小窝">水水的小窝</a>
                            </li>
                            <li class="footer-section-nav-list nav-list">
                              <a href="https://daisuke.moe" title="白兔">白兔</a>
                            </li>
                        </ul>
                    </nav>
                </section>
                <section class="footer-section copyright">
                    <p>Copyright © 2018 Nasy</p>
                </section>
                <div style="text-align: right;">
                    <p style="position: fixed; bottom: 0px; right: 10vw;" onclick="up2top();">
                        <i class="fas fa-rocket fa-lg" title="up to top" data-fa-transform="rotate--45"></i>
                    </p>
                </div>
            </footer>
        </div>
        <!-- highlight -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

        <!-- momentjs -->
        <script defer src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.0/moment.min.js"></script>

        <!-- fontawesome -->
        <script async defer src="../../scripts/fa-brands.min.js"></script>
        <script async defer src="../../scripts/fa-solid.min.js"></script>
        <script async defer src="../../scripts/fa-regular.min.js"></script>
        <script async defer src="../../scripts/fontawesome.min.js"></script>

        <script src="../../scripts/main.js" charset="utf-8"></script>

        <!-- MathJax -->
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

        <script type="text/javascript">
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            ga('create', 'UA-102577027-1', 'auto');
            ga('send', 'pageview');
        </script>
        <script async src="https://www.google-analytics.com/analytics.js"></script>
        <script>
            if (window.performance) {
                // Gets the number of milliseconds since page load
                // (and rounds the result since the value must be an integer).
                var timeSincePageLoad = Math.round(performance.now());

                // Sends the timing hit to Google Analytics.
                ga('send', 'timing', 'JS Dependencies', 'load', timeSincePageLoad);
            }
            function handleOutboundLinkClicks(event) {
                ga('send', 'event', {
                eventCategory: 'Outbound Link',
                eventAction: 'click',
                eventLabel: event.target.href,
                transport: 'beacon'
                });
            }
        </script>
    </body>
</html>
